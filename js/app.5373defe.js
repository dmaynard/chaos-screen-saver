(function(t){function e(e){for(var i,r,o=e[0],h=e[1],c=e[2],u=0,d=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&d.push(s[r][0]),s[r]=0;for(i in h)Object.prototype.hasOwnProperty.call(h,i)&&(t[i]=h[i]);m&&m(e);while(d.length)d.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],i=!0,r=1;r<a.length;r++){var o=a[r];0!==s[o]&&(i=!1)}i&&(n.splice(e--,1),t=c(c.s=a[0]))}return t}var i={},s={app:0},n=[];function r(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-5467a4aa":"deac17a5","chunk-2d0baa9a":"af36e859"}[t]+".js"}var o={};var h={"0d6c":function(){return{"./rust_wasm_attractor_bg.js":{__wbindgen_object_drop_ref:function(t){return i["d7a1"].exports["o"](t)},__wbg_instanceof_Window_11e25482011fc506:function(t){return i["d7a1"].exports["g"](t)},__wbg_performance_9d1ecf711183e1d5:function(t){return i["d7a1"].exports["j"](t)},__wbg_now_44a034aa2e1d73dd:function(t){return i["d7a1"].exports["i"](t)},__wbg_call_ba36642bd901572b:function(t,e){return i["d7a1"].exports["d"](t,e)},__wbindgen_object_clone_ref:function(t){return i["d7a1"].exports["n"](t)},__wbg_self_bb69a836a72ec6e9:function(){return i["d7a1"].exports["k"]()},__wbg_window_3304fc4b414c9693:function(){return i["d7a1"].exports["l"]()},__wbg_globalThis_e0d21cabc6630763:function(){return i["d7a1"].exports["e"]()},__wbg_global_8463719227271676:function(){return i["d7a1"].exports["f"]()},__wbindgen_is_undefined:function(t){return i["d7a1"].exports["m"](t)},__wbg_newnoargs_9fdd8f3961dd1bee:function(t,e){return i["d7a1"].exports["h"](t,e)},__wbindgen_throw:function(t,e){return i["d7a1"].exports["p"](t,e)}}}}};function c(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.e=function(t){var e=[],a=s[t];if(0!==a)if(a)e.push(a[2]);else{var i=new Promise((function(e,i){a=s[t]=[e,i]}));e.push(a[2]=i);var n,u=document.createElement("script");u.charset="utf-8",u.timeout=120,c.nc&&u.setAttribute("nonce",c.nc),u.src=r(t);var d=new Error;n=function(e){u.onerror=u.onload=null,clearTimeout(l);var a=s[t];if(0!==a){if(a){var i=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+i+": "+n+")",d.name="ChunkLoadError",d.type=i,d.request=n,a[1](d)}s[t]=void 0}};var l=setTimeout((function(){n({type:"timeout",target:u})}),12e4);u.onerror=u.onload=n,document.head.appendChild(u)}var m={"chunk-5467a4aa":["0d6c"]}[t]||[];return m.forEach((function(t){var a=o[t];if(a)e.push(a);else{var i,s=h[t](),n=fetch(c.p+""+{"0d6c":"f0abddc13338f8241326"}[t]+".module.wasm");if(s instanceof Promise&&"function"===typeof WebAssembly.compileStreaming)i=Promise.all([WebAssembly.compileStreaming(n),s]).then((function(t){return WebAssembly.instantiate(t[0],t[1])}));else if("function"===typeof WebAssembly.instantiateStreaming)i=WebAssembly.instantiateStreaming(n,s);else{var r=n.then((function(t){return t.arrayBuffer()}));i=r.then((function(t){return WebAssembly.instantiate(t,s)}))}e.push(o[t]=i.then((function(e){return c.w[t]=(e.instance||e).exports})))}})),Promise.all(e)},c.m=t,c.c=i,c.d=function(t,e,a){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)c.d(a,i,function(e){return t[e]}.bind(null,i));return a},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="",c.oe=function(t){throw console.error(t),t},c.w={};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],d=u.push.bind(u);u.push=e,u=u.slice();for(var l=0;l<u.length;l++)e(u[l]);var m=d;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";a("5a56")},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("a026"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{padding:"0px"},attrs:{id:"app"}},[a("chaos-canvas",{staticStyle:{width:"100%",height:"100%"}})],1)},n=[],r=(a("99af"),a("d3b7"),a("25f0"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"chaos-canvas-wrapper"},[a("h3",{attrs:{align:"center"}},[t._v(" Using "+t._s(t.language)+" ")]),a("canvas",{ref:"chaos-canvas",attrs:{id:"mycanvas"},on:{click:function(e){return t.resetAttractor(!1)}}}),a("span",{staticClass:"menu-wrapper",staticStyle:{width:"150px"}},[t.menuUp?a("div",[a("button",{staticClass:"close labeltag",on:{click:t.toggleMenuUp}},[t._v(" X ")]),a("myprogressbar",{attrs:{size:"medium","bar-color":t.pbarcolor,"bg-color":t.pbgcolor,val:t.progress}}),a("myprogressbar",{attrs:{id:"lastprogressbar",size:"medium","bar-color":t.tbarcolor,"bg-color":t.pbgcolor,val:t.countdownpct}}),t.useRust?a("div",[a("button",{ref:"useES6",staticClass:"uiButton",attrs:{id:"useES6Button"},on:{click:t.switchToES6}},[t._v(" Use ES6 ")])]):a("div",[a("button",{ref:"useRust",staticClass:"uiButton",attrs:{id:"useRustButton"},on:{click:t.switchToRust}},[t._v(" Use WASM ")])]),a("div",[a("vue-speedometer",{attrs:{id:"Iterations",value:t.meanItersPerMillisonds,width:150,height:100,"max-value":2e4}}),a("label",{attrs:{id:"itersperms",align:"center",for:"Iterations"}},[t._v("Pixels per ms ")]),t.paused?a("div",[a("button",{ref:"resume",staticClass:"uiButton",on:{click:t.startAnimation}},[t._v(" Resume ")])]):a("div",[a("button",{ref:"pause",staticClass:"uiButton",attrs:{id:"pauseButton"},on:{click:t.pauseAnimation}},[t._v(" Pause ")])]),a("button",{ref:"next",staticClass:"uiButton",on:{click:function(e){return t.resetAttractor(!0)}}},[t._v(" Next ")]),a("button",{staticClass:"uiButton",on:{click:t.doTestAttractor}},[t._v(" Test ")]),a("button",{staticClass:"uiButton",attrs:{id:"about"},on:{click:t.doAbout}},[t._v(" About ")])],1)],1):a("div",[a("span",[a("button",{staticClass:"close labeltag",staticStyle:{float:"left"},attrs:{id:"menubutton"},on:{click:t.toggleMenuUp}},[t._v(" â˜° ")])])]),t.menuUp?a("div"):a("div",[a("myprogressbar",{staticClass:"shorty",attrs:{id:"firstshortprogressbar",size:"small","bar-color":t.pbarcolor,"bg-color":t.pbgcolor,val:t.progress}}),a("myprogressbar",{staticClass:"shorty",attrs:{id:"secondprogressbar",size:"small","bar-color":t.tbarcolor,"bg-color":t.pbgcolor,val:t.countdownpct}})],1)])])}),o=[],h=(a("3ca3"),a("ddb0"),a("b0c0"),a("ace4"),a("5cc6"),a("907a"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("a7e3")),c=a.n(h),u=a("7840"),d=a.n(u),l=a("3835"),m=a("d4ec"),f=a("bee2"),p=(a("8a59"),a("cb29"),.1),g=.1,w=-2.3983540752995394,b=-1.8137134453341095,v=.010788338377923257,_=1.0113015602664608,y=-100,x=100,A=-100,D=100,I=1,k=1,M=0,P=0,R=0,S=null,j=function(){function t(e,a,i,s,n,r,o,h){Object(m["a"])(this,t),w=n,b=r,v=o,_=h,i=i,s=s,this.width=e,this.iters=0,this.loopCount=0,this.height=a,M=0,P=0,y=-100,x=100,A=-100,D=100,I=1,k=1,R!=e*a*4?(R=e*a*4,this.data=new Uint8ClampedArray(e*a*4),this.data.fill(255),S=this.data,new DataView(this.data.buffer),console.log("New AttractorObj allocating ",R)):(this.data=S,this.data.fill(255))}return Object(f["a"])(t,[{key:"getn_touched",value:function(){return M}},{key:"getn_maxed",value:function(){return P}},{key:"calculate_frame",value:function(t,e,a){var i=performance.now(),s=0,n=0;if(e){p=.1,g=.1;while(this.iters<a){this.iters++,n++;var r=this.iteratePoint(p,g),o=Object(l["a"])(r,2);p=o[0],g=o[1],p<x&&(x=p),p>y&&(y=p),g<D&&(D=g),g>A&&(A=g)}I=y-x,k=A-D}else while(s<t){this.iters++,n++;var h=this.iteratePoint(p,g),c=Object(l["a"])(h,2);p=c[0],g=c[1],this.decPixel(this.pixelx(p),this.pixely(g)),0==(63&n)&&(s=performance.now()-i)}return n}},{key:"iteratePoint",value:function(t,e){return[Math.sin(e*b)-v*Math.sin(t*b),Math.sin(t*w)+_*Math.cos(e*w)]}},{key:"pixelx",value:function(t){var e=Math.floor((t-x)/I*this.width);return e=e<0?0:e,e=e>this.width-1?this.width-1:e,e}},{key:"pixely",value:function(t){var e=Math.floor((t-D)/k*this.height);return e=e<0?0:e,e=e>this.height-1?this.height-1:e,e}},{key:"decPixel",value:function(t,e){var a=4*(e*this.width+t);255==this.data[a]&&M++,1==this.data[a]&&P++,this.data[a]>0&&(this.data[a]-=1,this.data[a+1]-=1,this.data[a+2]-=1)}},{key:"free_pixels",value:function(){}}]),t}(),C=6,z={components:{VueSpeedometer:d.a,myprogressbar:c.a},data:function(){return{ctx:null,image:null,imageData:null,putImageData:null,data:null,randomize:0,frames:0,iters:0,paused:!1,startNewAttractor:!0,displayDelayDefault:600,displayDelay:0,initialIterations:1e4,pbarcolor:"rgba(0,200,0,0.5)",tbarcolor:"rgba(240,180,0,0.5)",pbgcolor:"rgba(255, 225, 255, 0.0)",elapsedCPU:0,enoughMaxed:10,progress:0,menuUp:!0,prevMaxed:0,prevTouched:0,nFramesSame:0,window:{width:0,height:0},x:.1,y:.1,animationRequestID:null,msFrameBudget:13,att:null,framePerfs:new Array(Math.pow(2,C)),meanItersPerMillisonds:0,countdownpct:0,wasmPromise:null,wasm:null,wasmbg:null,useRust:!1,language:"ES6 to Javascript",aboutUrl:"https://github.com/dmaynard/chaos-screen-saver/blob/master/README.md"}},created:function(){window.addEventListener("resize",this.handleResize),this.handleResize()},destroyed:function(){window.removeEventListener("resize",this.handleResize),this.animationRequestID&&window.cancelAnimationFrame(this.animationRequestID)},mounted:function(){var t=this;this.$refs["chaos-canvas"].width=this.$refs["chaos-canvas"].parentElement.clientWidth,this.$refs["chaos-canvas"].height=this.$refs["chaos-canvas"].parentElement.clientHeight,this.ctx=this.$refs["chaos-canvas"].getContext("2d"),this.width=this.$refs["chaos-canvas"].width,this.height=this.$refs["chaos-canvas"].height,this.image=new Image(this.width,this.height),this.ctx.drawImage(this.image,0,0,this.width,this.height,0,0,this.width,this.height),this.imageData=this.ctx.getImageData(0,0,this.width,this.height),this.data=this.imageData.data,this.paused=!1,this.animationRequestID=window.requestAnimationFrame(this.doAnimation),this.wasmPromise=Promise.all([a.e("chunk-5467a4aa"),a.e("chunk-2d0baa9a")]).then(a.bind(null,"37bb")).then((function(e){t.wasm=e})).catch((function(t){return alert("Failed to load wasm module"+t)})),a.e("chunk-5467a4aa").then(a.bind(null,"0d6c")).then((function(e){t.wasmbg=e})).catch((function(t){return alert("Failed to load wasmbg module"+t)})),this.att=this.allocAttractorObj()},methods:{initImageData:function(t,e){this.width=t,this.height=e,this.$refs["chaos-canvas"].width=t,this.$refs["chaos-canvas"].height=e,this.ctx=this.$refs["chaos-canvas"].getContext("2d"),this.width=this.$refs["chaos-canvas"].width,this.height=this.$refs["chaos-canvas"].height,this.image=new Image(this.width,this.height),this.ctx.drawImage(this.image,0,0,this.width,this.height,0,0,this.width,this.height),this.imageData=this.ctx.getImageData(0,0,this.width,this.height),this.data=this.imageData.data,this.fillImage(255,255,255),this.ctx.putImageData(this.imageData,0,0)},handleResize:function(){this.$refs["chaos-canvas"]&&(this.animationRequestID&&window.cancelAnimationFrame(this.animationRequestID),this.randomize=2,this.startNewAttractor=!0,this.initImageData(window.innerWidth,window.innerHeight),this.animationRequestID=window.requestAnimationFrame(this.doAnimation))},timeIt:function(t,e){for(var a=-performance.now(),i=arguments.length,s=new Array(i>2?i-2:0),n=2;n<i;n++)s[n-2]=arguments[n];return e.call.apply(e,[t].concat(s)),a+=performance.now(),window.console.log(e.name+" : "+a+" ms"),a},invert:function(t,e,a){for(var i=0;i<this.att.data.length;i+=4)this.att.data[i]^=t,this.att.data[i+1]^=e,this.att.data[i+2]^=a},zeroImage:function(){for(var t=0;t<this.att.data.length;t+=4)this.att.data[t]=0,this.att.data[t+1]=0,this.att.data[t+2]=0,this.att.data[t+3]=255},fillImage:function(t,e,a){for(var i=0;i<this.att.data.length;i+=4)this.att.data[i]=t,this.att.data[i+1]=e,this.att.data[i+2]=a,this.att.data[i+3]=255},clickMethod:function(){this.timeIt(this,this.invert,255,255,255),this.timeIt(this.ctx,this.ctx.putImageData,this.imageData,0,0)},timeTest:function(){this.zeroImage(),this.timeIt(this,this.testAttractor)},doAnimation:function(){var t=performance.now();if(this.frames++,this.paused)this.animationRequestID=window.requestAnimationFrame(this.doAnimation);else{if(this.displayDelay>0)return this.displayDelay--,this.calculateProgress(this.displayDelay),void(this.animationRequestID=window.requestAnimationFrame(this.doAnimation));this.prevMaxed=this.att?this.att.getn_maxed():0,this.prevTouched=this.att?this.att.getn_touched():0,this.startNewAttractor&&(this.startTime=performance.now()),this.iterateAttractor(this.startNewAttractor,this.randomize),this.startNewAttractor=!1,this.att.getn_touched()>0&&this.att.getn_touched()<500&&(this.startNewAttractor=!0,this.displayDelay=0),this.att.getn_touched()==this.prevTouched&&this.att.getn_maxed()==this.prevMaxed?(this.nFramesSame++,this.nFramesSame>120&&(this.startNewAttractor=!0,this.progress=100,this.displayDelay=this.displayDelayDefault)):this.nFramesSame=0;var e=100*this.att.getn_maxed()/this.att.getn_touched();this.progress=Math.min(100*e/this.enoughMaxed,100),this.calculateProgress(this.displayDelay),e>this.enoughMaxed&&(this.startNewAttractor=!0,this.displayDelay=this.att.getn_touched()>5e3?this.displayDelayDefault:0),this.elapsedCPU+=performance.now()-t,this.elapsedCPU<0&&console.log(" impossible "),this.framesPerSecond=Math.floor(.5+1e3*this.frames/(performance.now()-this.startTime)),this.startAnimation&&window.cancelAnimationFrame(this.animationRequestID),this.animationRequestID=window.requestAnimationFrame(this.doAnimation)}},startAnimation:function(){this.paused=!1},pauseAnimation:function(){this.paused=!0},doToggleRust:function(){},switchToRust:function(){this.useRust=!0,this.language="Rust compiled to WASM (Web Assembly)",this.randomize=2,this.resetAttractor()},switchToES6:function(){this.useRust=!1,this.language="ES6 to Javascript",this.randomize=2,this.resetAttractor()},resetAttractor:function(){this.paused&&(this.paused=!1),this.displayDelay=0,this.startNewAttractor=!0},iterateAttractor:function(t,e){var a=1,i=0;t&&(this.frames=0,this.att=this.allocAttractorObj(this.width,this.height));var s=performance.now();i=this.att.calculate_frame(this.msFrameBudget,t,this.initialIterations),a=performance.now()-s,this.framePerfs[this.frames&Math.pow(2,C)-1]=i/a,this.meanItersPerMillisonds=Math.round(this.framePerfs.reduce((function(t,e){return t+e}),0)/this.framePerfs.length),t||(this.imageData.data.set(this.att.data),this.ctx.putImageData(this.imageData,0,0))},toggleMenuUp:function(){this.menuUp=!this.menuUp,this.imageData.data.set(this.att.data),this.ctx.putImageData(this.imageData,0,0)},doAbout:function(){window.open(this.aboutUrl,"_blank")},doTestAttractor:function(){this.randomize=1,this.startNewAttractor=!0,this.att.calculate_frame(this.msFrameBudget,!0,this.initialIterations),this.initImageData(window.innerWidth,window.innerHeight),this.animationRequestID=window.requestAnimationFrame(this.doAnimation)},calculateProgress:function(t){this.countdownpct=0==t?0:100*(this.displayDelayDefault-t)/this.displayDelayDefault},allocAttractorObj:function(t,e){switch(this.randomize){case 0:this.a=3*(2*Math.random()-1),this.b=3*(2*Math.random()-1),this.c=2*Math.random()-1+.5,this.d=2*Math.random()-1+.5;break;case 1:this.a=-2.3983540752995394,this.b=-1.8137134453341095,this.c=.010788338377923257,this.d=1.0113015602664608,this.randomize=0;break;case 2:break;default:}if(this.useRust){this.att&&this.att.free_pixels();var a=this.wasm.AttractorObj.new(this.width,this.height,this.x,this.y,this.a,this.b,this.c,this.d),i=a.pixels();return a.data=new Uint8Array(this.wasmbg.memory.buffer,i,this.width*this.height*4),this.imageData.data.set(a.data),this.ctx.putImageData(this.imageData,0,0),this.randomize=0,a}return this.randomize=0,new j(this.width,this.height,this.x,this.y,this.a,this.b,this.c,this.d)}}},O=z,E=(a("f23d"),a("0c7c")),T=Object(E["a"])(O,r,o,!1,null,"2be5180c",null),q=T.exports;i["a"].config.errorHandler=function(t,e,a){alert("Error: ".concat(t.toString(),"\nInfo: ").concat(a))};var F={name:"App",components:{ChaosCanvas:q},data:function(){return{darkmode:!1}}},U=F,$=(a("034f"),Object(E["a"])(U,s,n,!1,null,null,null)),B=$.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t(B)}}).$mount("#app")},"5a56":function(t,e,a){},f23d:function(t,e,a){"use strict";a("fa8b")},fa8b:function(t,e,a){}});
//# sourceMappingURL=app.5373defe.js.map